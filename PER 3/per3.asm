.EQU KEY_INPUT = 0x22
.EQU OUTPUT = 0x42
.EQU OUT_LED1 = 0x43
.EQU OUT_LED2 = 0x44
.EQU OUT_LED3 = 0x45
.EQU OUT_LED4 = 0x46
.EQU OUT_LED5 = 0x47
.EQU OUT_LED6 = 0x48

.CSEG
.ORG 0x01
;TEST TO SEE IF A SPECIFIC KEY SEQUENCE IS CORRECT. TEST TO SEE IF 7624AB.

CLI
MOV R0, 0x00
MOV R1, 0x00
MOV R2, 0x00

DIGIT_1: 
IN R0, KEY_INPUT
MOV R2, R0
SEI
CMP R0, 0x07
BRNE DIGIT_1
BREQ DIGIT_2

DIGIT_2:
CLI 
IN R0, KEY_INPUT
MOV R3, R0
SEI
CMP R3, 0x06
BRNE DIGIT_2
BREQ DIGIT_3

DIGIT_3: 
CLI 
IN R0, KEY_INPUT
MOV R4, R0
SEI
CMP R4, 0x02
BRNE DIGIT_3
BREQ DIGIT_4

DIGIT_4: 
CLI 
IN R0, KEY_INPUT
MOV R5, R0
SEI
CMP R5, 0x04
BRNE DIGIT_4
BREQ DIGIT_5

DIGIT_5: 
CLI 
IN R0, KEY_INPUT
MOV R6, R0
SEI
CMP R6, 0x0A
BRNE DIGIT_5
BREQ DIGIT_6

DIGIT_6: 
CLI 
IN R0, KEY_INPUT
MOV R7, R0
SEI
CMP R7, 0x0B
BRNE DIGIT_6
BREQ DONE

DONE:
MOV R1, 0x01
OUT R1, OUTPUT

ISR: 
CMP R2, 0x07
BRNE CALLBACK
OUT R2, OUT_LED1
CMP R0, 0x06
BRNE CALLBACK
OUT R3, OUT_LED2
CMP R0, 0x02
BRNE CALLBACK
OUT R4, OUT_LED3
CMP R0, 0x04
BRNE CALLBACK
OUT R5, OUT_LED4
CMP R0, 0x0A
BRNE CALLBACK
OUT R6, OUT_LED5
CMP R0, 0x0B
BRNE CALLBACK
OUT R7, OUT_LED6
RETID

CALLBACK:
RETID

.ORG 0x3FF
VECTOR: BRN ISR